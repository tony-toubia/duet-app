# Duet App - Coturn TURN Server Configuration
# Deploy on a server with public IP and open ports 3478, 5349, 49152-65535

# =====================
# NETWORK SETTINGS
# =====================

# TURN listener port (UDP and TCP)
listening-port=3478

# TLS listener port
tls-listening-port=5349

# Public IP of your server (REQUIRED - replace with your server's public IP)
# You can also use external-ip=auto if running with DETECT_EXTERNAL_IP=yes
external-ip=YOUR_SERVER_PUBLIC_IP

# Relay IP range for media
min-port=49152
max-port=65535

# =====================
# AUTHENTICATION
# =====================

# Realm (use your domain)
realm=turn.yourdomain.com

# Static credentials (simple setup)
# Generate a strong password: openssl rand -hex 32
user=duet:REPLACE_WITH_STRONG_PASSWORD

# For production, use long-term credentials with a shared secret:
# use-auth-secret
# static-auth-secret=YOUR_SHARED_SECRET
# This allows time-limited credentials generated by your backend

# =====================
# SECURITY
# =====================

# Fingerprint for STUN messages
fingerprint

# Long-term credential mechanism
lt-cred-mech

# Disable anonymous/insecure options
no-multicast-peers
no-cli
no-tlsv1
no-tlsv1_1

# Rate limiting
max-bps=1000000
total-quota=100
stale-nonce=600

# =====================
# TLS/SSL (Recommended for production)
# =====================

# Uncomment and configure for TLS support
# cert=/etc/coturn/certs/fullchain.pem
# pkey=/etc/coturn/certs/privkey.pem

# =====================
# LOGGING
# =====================

# Log to stdout (for Docker)
log-file=stdout

# Verbose logging (disable in production)
# verbose

# =====================
# PERFORMANCE
# =====================

# Number of relay threads (adjust based on server CPU)
relay-threads=4

# Disable UDP self-balancing (for single-server)
no-udp-relay

# Disable TCP relay (most clients use UDP)
# no-tcp-relay

# =====================
# OPTIONAL: Redis for multi-server
# =====================

# redis-userdb="ip=127.0.0.1 dbname=0 password=YOUR_REDIS_PASSWORD"
